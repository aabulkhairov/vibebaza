---
title: mcpcap MCP сервер
description: Модульный Python MCP сервер для анализа PCAP (сетевые захваты пакетов) файлов с инструментами анализа специфичных протоколов DNS, DHCP, ICMP и анализа метаданных файлов.
tags:
- Security
- Analytics
- Monitoring
- DevOps
author: mcpcap
featured: false
---

Модульный Python MCP сервер для анализа PCAP (сетевые захваты пакетов) файлов с инструментами анализа специфичных протоколов DNS, DHCP, ICMP и анализа метаданных файлов.

## Установка

### pip

```bash
pip install mcpcap
```

### uv

```bash
uv add mcpcap
```

### uvx (одноразовое использование)

```bash
uvx mcpcap
```

## Конфигурация

### Claude Desktop

```json
{
  "mcpServers": {
    "mcpcap": {
      "command": "mcpcap",
      "args": []
    }
  }
}
```

## Доступные инструменты

| Инструмент | Описание |
|------|-------------|
| `analyze_dns_packets` | Полный анализ DNS трафика включая запросы, ответы, домены, типы запросов и безопасность... |
| `analyze_dhcp_packets` | Полный анализ DHCP трафика включая транзакции, назначения IP, информацию об аренде и ано... |
| `analyze_icmp_packets` | Полный анализ ICMP трафика включая ping запросы/ответы, время отклика, TTL значения и а... |
| `analyze_capinfos` | Метаданные PCAP файла и статистика включая информацию о файле, количество пакетов, временной анализ и пропу... |

## Возможности

- Инструменты MCP без состояния - каждый анализ принимает пути к PCAP файлам или URL как параметры
- Модульная архитектура - модули DNS, DHCP, ICMP и CapInfos с простой расширяемостью
- Поддержка локальных и удаленных PCAP - анализируйте файлы из локального хранилища или HTTP URL
- Интеграция Scapy - использует комплексные возможности парсинга пакетов
- Специализированные промпты анализа - руководства по анализу безопасности, сети и криминалистики
- JSON ответы - структурированный формат данных, оптимизированный для потребления LLM
- Поддержка файлов .pcap, .pcapng и .cap
- Автоматическое временное скачивание и очистка для удаленных файлов

## Примеры использования

```
Анализ DNS пакетов из локального файла: analyze_dns_packets('/path/to/dns.pcap')
```

```
Анализ DHCP пакетов с удаленного URL: analyze_dhcp_packets('https://example.com/dhcp-capture.pcap')
```

```
Анализ ICMP трафика для проблем сетевого подключения: analyze_icmp_packets('/path/to/icmp.pcap')
```

```
Получить метаданные PCAP файла и статистику: analyze_capinfos('/path/to/any.pcap')
```

```
Выполнить анализ безопасности DNS трафика для обнаружения угроз и DNS туннелирования
```

## Ресурсы

- [GitHub Repository](https://github.com/mcpcap/mcpcap)

## Примечания

Требует Python 3.10+. Поддерживает опции командной строки, такие как --modules для загрузки специфичных модулей (dns, dhcp, icmp, capinfos) и --max-packets для ограничения анализа больших файлов. Включает специализированные промпты анализа для анализа безопасности, устранения неполадок сети и криминалистического расследования во всех модулях протоколов.